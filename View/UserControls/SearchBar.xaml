<UserControl x:Class="ITEQ2.View.UserControls.SearchBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ITEQ2.View.UserControls"
             mc:Ignorable="d" 
             d:DesignHeight="80" d:DesignWidth="1000">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="auto"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>



        <StackPanel Grid.Column="0" HorizontalAlignment="Left" Orientation="Horizontal">
            <Button x:Name="BtnRefresh" Height="30" Width="30" Margin="5" VerticalAlignment="Top" 
                Content="🔄" Click="BtnRefresh_Click"/>
            <Button x:Name="BtnAddRow" Height="30" Width="120" Margin="5" VerticalAlignment="Top"
                Content="Add new Equipment" Click="BtnAddRow_Click"/>
            <Button x:Name="BtnCreateGridPreset" Height="30" Width="120" Margin="5" VerticalAlignment="Top" 
                Content="Save Grid Preset" Click="BtnCreateGridPreset_Click"/>
            <Button x:Name="BtnSetValuesForSelectedRows" Margin="5" Height="30" Width="160" VerticalAlignment="Top"  
                Content="Set values for selected rows" Click="BtnSetValuesForSelectedRows_Click"/>
        </StackPanel>
        <TextBox Grid.Column="1" x:Name="txtBoxSearchBar" Height="30" Width="auto" Margin="5" VerticalAlignment="Top" HorizontalAlignment="Stretch"
                 FontSize="16" TextChanged="txtBoxSearchBar_TextChanged"/>



        <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
            
            <Button x:Name="HelpButton" Width="30" Height="30" Margin="5,0,5,0"
            Padding="0" Background="Transparent" BorderBrush="Transparent"
            ToolTip="Click for search help"
            Click="btnSearchInfo_Click" Cursor="Hand">
                <TextBlock Text="ℹ️" FontSize="20" VerticalAlignment="Center"/>
            </Button>

            <Popup x:Name="HelpPopup" PlacementTarget="{Binding ElementName=HelpButton}"
           Placement="Bottom" StaysOpen="False">
                <Border Background="#FFFDFDFD" BorderBrush="Gray" BorderThickness="1" CornerRadius="5"
                Padding="10" MaxWidth="300" >
                    <TextBlock TextWrapping="Wrap">
                <Bold>
                Searches are not case sensitive!<LineBreak/></Bold>
                • Basic search: "<Bold>John</Bold>" returns all rows that include "<Bold>John</Bold>"<LineBreak/>
                        <LineBreak/>
                • Field search: "<Bold>User:John</Bold>" returns all rows that has "<Bold>John</Bold>" in the "<Bold>User</Bold>" field<LineBreak/>
                        <LineBreak/>
                • Combined search: <Bold>(User:John &amp;&amp; Make:HP) || Oslo</Bold> returns all instances where the <Bold>User column contains John AND the Make column contains HP, OR all instances of Oslo</Bold><LineBreak/>
                <LineBreak/>
                • Exclutionary search: <Bold>!John</Bold> returns all rows that does not include "<Bold>John</Bold>"<LineBreak/>
                        <LineBreak/>
                • Exclutionary combined search: <Bold>(!User:John &amp;&amp; Make:HP) || Oslo</Bold> returns all instances where the <Bold>User column does NOT contain John AND the Make column contains HP, OR all instances of Oslo</Bold>
                    </TextBlock>
                </Border>
            </Popup>
            
            
            <TextBlock 
               MinWidth="250"
               Text="{Binding SearchErrorFeedback, RelativeSource={RelativeSource AncestorType=UserControl}}"
               TextWrapping="Wrap"
               Foreground="DarkRed"
               Margin="0"
               Padding="0,5,0,5"
               FontSize="14"
               FontWeight="Bold"
               VerticalAlignment="Center"
               HorizontalAlignment="Left"/>
        </StackPanel>
    </Grid>
</UserControl>
